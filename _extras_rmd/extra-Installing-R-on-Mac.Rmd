---
title: "Installing R, RStudio, and QGIS on a Mac"
questions:
- Do I want to install the software before the workshop?
- Can I download a few Gb of installation files and data files over my network?
- Am I comfortable with running package installation scripts in R Studio?
objectives:
- If you'd like an instructor's assistance, we recommend you wait until the workshop.
- If you'd like to experiment on your own, you can follow these instructions.
source: Rmd
---


<!-- JPN: updated fig path here manually for plots to show, it turns out this is unneccesary though-->

```{r setup, include=FALSE}
#knitr::opts_chunk$set(echo = TRUE, fig.path='../figure/')
library(knitr)
library(httr)
source("../bin/chunk-options.R")
```

# Installing R and RStudio

## Before you start

1. Check which version of Mac OS you have. To do this, click on the Apple icon on the top-left of your screen, then click "About This Mac". A little window should pop up with version information.

<img src="../figure/which_mac_version.png" width="50%">  


2. Make sure that you have about 500 MB of free space on your machine. We will need this space to install both R and RStudio, and when the program installs the compressed files expand to take much more space.  

## Installing R

1. Go to [this website](https://cran.r-project.org/bin/macosx/).

2. If your mac is OS X 10.11 and higher (this should be the case for most of you), click the `R-3.6.2.pkg` link. If your mac is OS X 10.9 or 10.10, click the `R-3.3.3.pkg` link.  

3. After clicking on the link, the file (package installer) will be downloaded onto your computer. Once the file has been downloaded, click on the `.pkg` file that downloads in your default Download folder and walk through the installation process. Accept the default options for now.

R is now **installed** on your computer.  

### Testing R

1. Double-click on the R icon in the Applications folder:

<img src="../figure/applications_folder_r.png" width="50%">

A window titled "R Console" should pop up:

<img src="../figure/R_Console.png" width="40%">  

The `>` character is called the prompt and is the place where we enter commands for the program to interpret. For instance, if you type `25+5` followed by the return/enter key, you will see:

```{r}
25+5
```

<img src="../figure/R_console_using.png" width="50%">

2. To quit R, call the quit function by going to `File -> Quit R`.


R will ask you if you want to save your work:

<img src="../figure/closing_r_dontSAve.png" width="50%">

Click on "Don't Save". You have now left R.  

We are not going to use R this way often, as we will use an integrated environment called RStudio.  

## Installing RStudio

1. Go to [this website](https://rstudio.com/products/rstudio/download/).

2. Click on the `Free` link (note: there are paid options, but we won't be using those!). The file download will begin.
  * If you have an older computer, you *may* have to find your installer on [this page](https://support.rstudio.com/hc/en-us/articles/206569407-Older-Versions-of-RStudio), but feel free to contact us about that!

3. Once the file has been downloaded, click on it. A window should pop up:

<img src="../figure/Rstudio_download.png" width="50%">

Click on the RStudio icon and drag it into the Applications folder. 

RStudio is now **installed** on your computer.

**Note**: For RStudio to work, R needs to be installed first.

### Testing RStudio

1. Double-click on the RStudio icon in the Applications:

<img src="../figure/applications_folder.png" width="50%">  

A window titled "RStudio" should pop up, looking something like this:

<img src="../figure/rstudio_opened.png" width="75%">

2. Just as in R, the `>` character in the Console window is where we enter commands for the program to interpret.  You can try entering something there and then hitting the `Enter` key to see:

```{r}
25+5
```


3. To exit RStudio, click "RStudio" in the menu bar, then click "Quit RStudio". Alternatively, use the `Cmd-Q` shortcut. If prompted to save the workspace, do not save it.







# Installing the geospatial and federal data packages

When RStudio is open and working, create a new R script file.

Here's where to make a new script:

<img src="../figure/mac_open_new_script.png" width="50%">

When you open a new script, your RStudio will now look like this (without the red labels):

<img src="../figure/rstudio_with_script_window_names.png" width="75%">

Once this is done copy the following into your script window:
```{r copyfuncscript, eval=FALSE}
source('https://raw.githubusercontent.com/data-carpentry-for-agriculture/trial-lesson/gh-pages/_episodes_rmd/package_install_script.R')
```

And follow it by pressing the `Source` button.  You might get some red words showing up, and that is normal!  If you see any red with the word `Error` in it, this may indicate a problem however.

This looks like:
<img src="../figure/sourceInstallScript.png" width="75%">

<!-- JPN: streamlined
* When RStudio is open and working, create a new R script file and copy in the 
contents of [this installation script file](https://github.com/data-carpentry-for-agriculture/trial-lesson/blob/gh-pages/_episodes_rmd/package_install_script.R). 

Here's where to make a new script:

<img src="../figure/mac_open_new_script.png" width="50%">

Once you copy and paste this in your script window, you can press the `Source` button to install the packages:

<img src="../figure/copy_install_script.png" width="75%">
-->

* If the red stop sign in the top right corner of the console is still highlighted, an installation process is still running.
* If you see a blue > in the console , you're ready to go.

This action is "sourcing" i.e. running a bit of code from the internet that installs a bunch of libraries that provide functionality that is not included with standard R installation.

Alternatively, you can copy the following into the script window or console:

```{r altInstall, eval=FALSE}
install.packages("ggplot2")
install.packages("rgdal") 
install.packages("dplyr") 
install.packages("sf")
install.packages("gstat")
install.packages("tmap")
install.packages("measurements")
install.packages("daymetr")
install.packages("FedData")
install.packages("lubridate")
install.packages("raster")
install.packages("data.table")
install.packages("broom")
```

## Checking that the packages installed correctly

We have a test script to make sure all packages have installed correctly.  To run this test script, we will "Source" it's location like we did above for the package installation script.

In your script window you can type in:

```{r installScriptFtest, eval=FALSE}
source('https://raw.githubusercontent.com/data-carpentry-for-agriculture/trial-lesson/gh-pages/_episodes_rmd/functions.R')
```

... and then press the `Source` button.  This will look like:

<img src="../figure/firstSourceFunctions.png" width="75%">

Next, we will run the test script to see what happens.  When we run this script, it will create a new directory called `WorkingDir` to save all of our test images in.  This directory will also be used to store data for this workshop.  (You can change the default creation location for `WorkingDir` by calling the function as `run_workshop_test(workingDir='YOUR DIR')`, shown below is how this looks for the default).

Once we press the `Source` some things will download and be calculated, and a new file called `WorkingDir` will show up in our file list:

<img src="../figure/install_create_wd.png" width="80%">

To check that all our images have been created, we can click on `WorkingDir` in our **File** list in RStudio (see #2 in above figure), and then navigate to `test_images`:

<img src="../figure/intoTestimages.png" width="80%">

Once you open this file, you should see several images:

<img src="../figure/open_image_folder.png" width="75%">

You can click on each of these to open them up.  Here is a grid of what each one should look like:

| &nbsp;    |  &nbsp;  |     &nbsp; |
|:---------:|:-------:|:--------:|
| plot1_ggplot2.jpg <br> <img src="../figure/test_images/plot1_ggplot2.jpg" width="250px"> | plot2_sf.jpg <br> <img src="../figure/test_images/plot2_sf.jpg" width="250px"> | plot3_gstat.jpg <br> <img src="../figure/test_images/plot3_gstat.jpg" width="250px"> | 
| plot4_tmap.jpg <br> <img src="../figure/test_images/plot4_tmap.jpg" width="250px"> | plot5_daymetr.jpg <br> <img src="../figure/test_images/plot5_daymetr.jpg" width="250px"> | plot6_ssurgo.jpg <br> <img src="../figure/test_images/plot6_ssurgo.jpg" width="250px"> | 
| plot7_raster.jpg <br> <img src="../figure/test_images/plot7_raster.jpg" width="250px"> | plot8_datatable.jpg <br> <img src="../figure/test_images/plot8_datatable.jpg" width="250px"> | plot9_broom.jpg <br> <img src="../figure/test_images/plot9_broom.jpg" width="250px"> | 


# Download data for this workshop

The final thing we need to do for this workshop is to download the data.  To do this, we need to run one more function.  To avoid re-running our test function, we can put a little `#` in front of this line.  So the code in our script will now look like:
```{r codeCommentROut, eval=FALSE}
source('https://raw.githubusercontent.com/data-carpentry-for-agriculture/trial-lesson/gh-pages/_episodes_rmd/functions.R')

#run_workshop_test()

download_workshop_data()
```

If we navigate to our `WorkingDir` directory we will see that a folder called `data` and a script called `functions.R` have now appeared.  This process looks like:

<img src="../figure/downloadData.png" width="80%">


<!-- JPN this is in the intro

### Checking that the packages installed correctly

* After you've run the installation items, create a new R script file and copy in the 
contents of [the package load and test file](https://raw.githubusercontent.com/data-carpentry-for-agriculture/trial-lesson/gh-pages/_episodes_rmd/package_load_and_test.R). 
* Run each line by selecting it and clicking the Run key. Each test should let you know whether an error was encountered in the loading process.

<img src="../figure/wininstall6-rstudiolibraryload.png" width="50%">

An example of one of the tests' output:

<img src="../figure/wininstall7-rstudiotmaptest.png" width="75%">
-->



# Download and Install QGIS

To download QGIS, visit [the QGIS download site](https://qgis.org/en/site/forusers/download.html) and choose one of the standalone installers. Be sure to check your Mac version to download the correct package.

Note: This is a ~1Gb file, so it's likely to take some time to download.

You should see a new icon in your Applications folder:

<img src="../figure/qgis_macInstall_applications.png" width="50%">

When you double click QGIS should open up:

<img src="../figure/qgis_macInstall_opened.png" width="75%">




Citation: R/RStudio install structure from <a href="https://github.com/kjytay">Kenneth Tay</a>
